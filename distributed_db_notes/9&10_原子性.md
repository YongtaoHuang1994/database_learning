原子性要求事务只有两种状态：
- 成功：所有操作全部成功
- 失败：所有操作全部失败，执行一半的立即回滚。

两种协议：
- TCC：应用层
- 2PC：资源层 不入侵业务 1977年

2PC的两个阶段
- 准备阶段（上锁）
- 提交阶段
两阶段自然会带来高时延问题。

![avatar](原子性.jpg)
![avatar](事务延迟.jpg)